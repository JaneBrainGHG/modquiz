<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Netami Mod Quiz</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #6c5ce7;
            --secondary-color: #a29bfe;
            --accent-color: #fd79a8;
            --background-color: #2d3436;
            --card-color: #353b48;
            --text-color: #f5f6fa;
            --correct-color: #00b894;
            --incorrect-color: #d63031;
            --note-color: #fff7a0;
            --note-shadow: rgba(0, 0, 0, 0.3);
            --board-color: #1e272e;
        }

        .dark-mode {
            --background-color: #000000;
            --card-color: #121212;
            --text-color: #ffffff;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        .container {
            max-width: 1200px;
            width: 95%;
            margin: 20px auto;
            position: relative;
            overflow: hidden;
            transition: all 0.5s ease;
            min-height: calc(100vh - 80px); /* Ensure space for footer */
            display: flex;
            flex-direction: column;
        }

        h1, h2, h3 {
            text-align: center;
            margin-bottom: 20px;
            color: var(--text-color);
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 30px;
        }

        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
            flex: 1;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .active {
            display: block;
        }

        .intro-text {
            text-align: center;
            margin-bottom: 30px;
            line-height: 1.6;
            font-size: 1.1rem;
        }

        .btn {
            display: inline-block;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 30px;
            text-decoration: none;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            margin-top: 20px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            outline: none;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn-container {
            display: flex;
            justify-content: center;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        /* Person selection area */
        .person-selection {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 15px;
            margin-bottom: 30px;
            background-color: var(--card-color);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .person-card {
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .person-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .person-card.selected {
            border: 3px solid var(--primary-color);
        }

        .person-card.used {
            opacity: 0.5;
            pointer-events: none;
        }

        .person-card.used::after {
            content: 'âœ•';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            color: var(--incorrect-color);
            background-color: rgba(0, 0, 0, 0.3);
        }

        .person-card.correct-answer {
            border: 3px solid var(--correct-color);
            box-shadow: 0 0 15px var(--correct-color);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }

        .person-image {
            width: 100%;
            height: 120px;
            object-fit: cover;
            display: block;
        }

        .person-name {
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px;
            text-align: center;
            font-size: 0.9rem;
        }

        /* Notes container at the bottom */
        .notes-container {
            margin: 30px 0;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Regular facts display */
        .facts-display {
            background-color: var(--card-color);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .fact-item {
            background-color: var(--note-color);
            color: #333;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        /* Hint buttons container */
        .hint-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .hint-btn {
            background-color: var(--secondary-color);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .hint-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .hint-btn:disabled {
            background-color: #888;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.7;
        }

        .key-hint-btn {
            background-color: #ffda79;
            color: #333;
        }

        .final-hint-btn {
            background-color: #ffb142;
            color: #333;
        }

        /* Hint modal */
        .hint-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .hint-modal-content {
            background-color: var(--note-color);
            color: #333;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .hint-modal-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #333;
        }

        .hint-modal-text {
            font-size: 1.2rem;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .hint-modal-close {
            background-color: var(--primary-color);
            color: white;
            padding: 10px 25px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .hint-modal-close:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .key-hint-modal .hint-modal-content {
            background-color: #ffda79;
        }

        .final-hint-modal .hint-modal-content {
            background-color: #ffb142;
        }

        .key-hint-badge, .final-hint-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
            transform: rotate(5deg);
        }

        .key-hint-badge {
            background-color: #e17055;
        }

        .final-hint-badge {
            background-color: #d63031;
        }

        .progress-container {
            width: 100%;
            height: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            width: 0;
            transition: width 0.5s ease;
            border-radius: 5px;
        }

        .round-indicator {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.2rem;
            color: var(--secondary-color);
        }

        .feedback {
            text-align: center;
            padding: 15px;
            margin: 20px 0;
            border-radius: 10px;
            font-weight: bold;
            animation: fadeIn 0.5s ease;
        }

        .feedback.correct {
            background-color: rgba(0, 184, 148, 0.2);
            color: var(--correct-color);
        }

        .feedback.incorrect {
            background-color: rgba(214, 48, 49, 0.2);
            color: var(--incorrect-color);
        }

        .score-summary {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background-color: var(--card-color);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 20px auto;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            font-weight: bold;
            background: conic-gradient(var(--primary-color) 0%, var(--accent-color) 100%);
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 130px;
            height: 130px;
            border-radius: 50%;
            background-color: var(--card-color);
        }

        .score-value {
            position: relative;
            z-index: 1;
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            background-color: var(--card-color);
        }

        .results-table th, .results-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .results-table th {
            background-color: rgba(0, 0, 0, 0.3);
            color: var(--accent-color);
            font-weight: bold;
        }

        .results-table tr:last-child td {
            border-bottom: none;
        }

        .results-table tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .correct-row {
            background-color: rgba(0, 184, 148, 0.1);
        }

        .incorrect-row {
            background-color: rgba(214, 48, 49, 0.1);
        }

        .result-icon {
            font-size: 1.2rem;
        }

        .correct-icon {
            color: var(--correct-color);
        }

        .incorrect-icon {
            color: var(--incorrect-color);
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            border-radius: 0;
            animation: confetti-fall 3s linear forwards;
            z-index: 1000;
            pointer-events: none;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Dark mode toggle */
        .dark-mode-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--card-color);
            color: var(--text-color);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            z-index: 100;
        }

        .dark-mode-toggle:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 15px;
            color: #888;
            font-size: 0.9rem;
            margin-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Confirmation dialog */
        .confirmation-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .dialog-content {
            background-color: var(--card-color);
            padding: 30px;
            border-radius: 15px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .dialog-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--accent-color);
        }

        .dialog-message {
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .dialog-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .dialog-btn {
            padding: 10px 20px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .confirm-btn {
            background-color: var(--primary-color);
            color: white;
        }

        .cancel-btn {
            background-color: var(--incorrect-color);
            color: white;
        }

        @media (max-width: 768px) {
            .person-selection {
                grid-template-columns: repeat(3, 1fr);
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .btn {
                padding: 12px 24px;
                font-size: 1rem;
            }
            
            .hint-buttons {
                flex-direction: column;
                align-items: center;
            }
        }

        @media (max-width: 480px) {
            .person-selection {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Start Screen -->
        <div class="screen active" id="start-screen">
            <h1>Netami Quiz</h1>
            
            <div class="btn-container">
                <button class="btn" id="start-btn">Start</button>
                <button class="btn" id="overview-btn">Ãœbersicht Modus</button>
            </div>
            
            <div class="footer">
                &copy; 2025 <i class="far fa-copyright"></i> Netami Mod Quiz - All Rights Reserved
            </div>
        </div>
        
        <!-- Quiz Screen -->
        <div class="screen" id="quiz-screen">
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <div class="round-indicator">Round <span id="current-round">1</span> of 6</div>
            
            <!-- Person selection area with images -->
            <div class="person-selection" id="person-selection">
                <!-- Person cards will be inserted here -->
            </div>
            
            <div id="feedback-container"></div>
            
            <!-- Facts display area -->
            <div class="notes-container" id="notes-container">
                <div class="facts-display" id="facts-display">
                    <!-- Regular facts will be displayed here -->
                </div>
                
                <!-- Hint buttons -->
                <div class="hint-buttons">
                    <button class="hint-btn key-hint-btn" id="key-hint-btn">Reveal Key Hint</button>
                    <button class="hint-btn final-hint-btn" id="final-hint-btn">Reveal Final Clue</button>
                </div>
            </div>
        </div>
        
        <!-- Results Screen -->
        <div class="screen" id="results-screen">
            <h1>Quiz Results</h1>
            
            <div class="score-summary">
                <h2>Your Score</h2>
                <div class="score-circle">
                    <span class="score-value" id="score-value">0/6</span>
                </div>
                <p id="score-text">You got 0 out of 6 correct!</p>
            </div>
            
            <h2>Your Answers</h2>
            <table class="results-table">
                <thead>
                    <tr>
                        <th>Round</th>
                        <th>Correct Person</th>
                        <th>Your Answer</th>
                        <th>Result</th>
                    </tr>
                </thead>
                <tbody id="results-table-body">
                    <!-- Results will be inserted here -->
                </tbody>
            </table>
            
            <div class="btn-container">
                <button class="btn" id="play-again-btn">Play Again</button>
            </div>
            
            <div class="footer">
                &copy; 2025 <i class="far fa-copyright"></i> Netami Quiz - All Rights Reserved
            </div>
        </div>
    </div>
    
    <!-- Dark mode toggle button -->
    <button class="dark-mode-toggle" id="dark-mode-toggle">
        <i class="fas fa-moon"></i>
    </button>
    
    <script>
        // Quiz data with structured facts and image URLs
        const people = {
            "MasterM142": {
                image: "/static/images/masterm142.png",
                regularFacts: [
                    "White Montser on Top",
                    "BMW M2 Competition",
                    "lil Doggo und cuzy on top(musiker)"
                ],
                keyFacts: [
                    "nicht gemocht bei der Community"
                ],
                finalFact: "Vergeben"
            },
            "Apple Piece": {
                image: "/static/images/applepeace.png",
                regularFacts: [
                    "Robben sind toll",
                    "3 Vornamen",
                    "gut in Badminton(ist nen Sport)"
                ],
                keyFacts: [
                    "undgesundes VerhÃ¤ltnis zu weiÃŸen Monster"
                ],
                finalFact: "Das einzige MÃ¤dchen im Moderator Team"
            },
            "Foxy": {
                image: "/static/images/foxy.png",
                regularFacts: [
                    "Hat 5 PCs in seinem Zimmer",
                    "Ist ein groÃŸer Fan von Fnaf",
                    "Friends vs Friends Fan"
                ],
                keyFacts: [
                    "Lebt in einer WG"
                ],
                finalFact: "Ist ein Furry"
            },
            "Ked": {
                image: "/static/images/ked.png",
                regularFacts: [
                    "Kochen",
                    "Lieblingsfarbe: Orange",
                    "Name Elias"
                ],
                keyFacts: [
                    "Angeln"
                ],
                finalFact: "Ã–sterreicher"
            },
            "ChaosBen": {
                image: "/static/images/chaosben.png",
                regularFacts: [
                    "versteht keine SpaÃŸ",
                    "Inaktivster Mod auf DC",
                    "Politisch"
                ],
                keyFacts: [
                    "hat ne 12tb database gelÃ¶scht"
                ],
                finalFact: "HartnÃ¤ckkig"
            },
            "Ned": {
                image: "/static/images/ned.png",
                regularFacts: [
                    "BBO$ Fav Rapper",
                    "Fav Game Minecraft",
                    "Spielt Gerne Tischtennis"
                ],
                keyFacts: [
                    "Schaut zuviel TonverÃ¤ndert"
                ],
                finalFact: "Neuer Mod"
            }
        };
        
        // Quiz state
        let currentRound = 0;
        let score = 0;
        let results = [];
        let currentPerson = '';
        let usedPeople = [];
        let overviewMode = false;
        let keyHintRevealed = false;
        let finalHintRevealed = false;
        
        // DOM elements
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const startBtn = document.getElementById('start-btn');
        const overviewBtn = document.getElementById('overview-btn');
        const playAgainBtn = document.getElementById('play-again-btn');
        const progressBar = document.getElementById('progress-bar');
        const currentRoundElement = document.getElementById('current-round');
        const notesContainer = document.getElementById('notes-container');
        const factsDisplay = document.getElementById('facts-display');
        const personSelection = document.getElementById('person-selection');
        const feedbackContainer = document.getElementById('feedback-container');
        const scoreValue = document.getElementById('score-value');
        const scoreText = document.getElementById('score-text');
        const resultsTableBody = document.getElementById('results-table-body');
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        
        // Verwende 'let' statt 'const' fÃ¼r diese Buttons, damit sie neu zugewiesen werden kÃ¶nnen
        let keyHintBtn = document.getElementById('key-hint-btn');
        let finalHintBtn = document.getElementById('final-hint-btn');
        
        // Show confirmation dialog
        function showConfirmationDialog(message, onConfirm) {
            const dialog = document.createElement('div');
            dialog.classList.add('confirmation-dialog');
            
            const content = document.createElement('div');
            content.classList.add('dialog-content');
            
            const title = document.createElement('div');
            title.classList.add('dialog-title');
            title.textContent = 'Confirm Action';
            
            const messageEl = document.createElement('div');
            messageEl.classList.add('dialog-message');
            messageEl.textContent = message;
            
            const buttons = document.createElement('div');
            buttons.classList.add('dialog-buttons');
            
            const confirmBtn = document.createElement('button');
            confirmBtn.classList.add('dialog-btn', 'confirm-btn');
            confirmBtn.textContent = 'Yes';
            confirmBtn.addEventListener('click', () => {
                document.body.removeChild(dialog);
                onConfirm();
            });
            
            const cancelBtn = document.createElement('button');
            cancelBtn.classList.add('dialog-btn', 'cancel-btn');
            cancelBtn.textContent = 'No';
            cancelBtn.addEventListener('click', () => {
                document.body.removeChild(dialog);
            });
            
            buttons.appendChild(confirmBtn);
            buttons.appendChild(cancelBtn);
            
            content.appendChild(title);
            content.appendChild(messageEl);
            content.appendChild(buttons);
            
            dialog.appendChild(content);
            document.body.appendChild(dialog);
        }
        
        // Create confetti effect for correct answers
        function createConfetti() {
            const colors = ['#6c5ce7', '#a29bfe', '#fd79a8', '#00b894', '#00cec9', '#fdcb6e'];
            const confettiCount = 100;
            
            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                
                // Random properties
                const size = Math.random() * 10 + 5;
                const posX = Math.random() * 100;
                const rotation = Math.random() * 360;
                const delay = Math.random() * 0.5;
                
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                confetti.style.left = `${posX}%`;
                confetti.style.top = '-20px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.transform = `rotate(${rotation}deg)`;
                confetti.style.animationDelay = `${delay}s`;
                
                document.body.appendChild(confetti);
                
                // Remove confetti after animation
                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }
        }
        
        // Display person selection cards
        function displayPersonSelection() {
            personSelection.innerHTML = '';
            const allPeople = Object.keys(people);
            
            allPeople.forEach(person => {
                const card = document.createElement('div');
                card.classList.add('person-card');
                card.dataset.person = person;
                
                // If this person was used in a previous round, mark as used
                if (usedPeople.includes(person)) {
                    card.classList.add('used');
                }
                
                const img = document.createElement('img');
                img.src = people[person].image;
                img.alt = person;
                img.classList.add('person-image');
                
                const name = document.createElement('div');
                name.classList.add('person-name');
                name.textContent = person;
                
                card.appendChild(img);
                card.appendChild(name);
                
                card.addEventListener('click', () => {
                    if (!card.classList.contains('used')) {
                        // Check answer immediately when a person is clicked
                        checkAnswer(person);
                    }
                });
                
                personSelection.appendChild(card);
            });
        }
        
        // Display facts for the current person
        function displayFacts(person) {
            // Reset hint states
            keyHintRevealed = false;
            finalHintRevealed = false;
            
            // Clear facts display
            factsDisplay.innerHTML = '';
            
            const personData = people[person];
            
            // Display regular facts
            personData.regularFacts.forEach(fact => {
                const factItem = document.createElement('div');
                factItem.classList.add('fact-item');
                factItem.textContent = fact;
                factsDisplay.appendChild(factItem);
            });
            
            // Remove old event listeners by cloning and replacing the buttons
            const newKeyHintBtn = keyHintBtn.cloneNode(true);
            const newFinalHintBtn = finalHintBtn.cloneNode(true);
            
            keyHintBtn.parentNode.replaceChild(newKeyHintBtn, keyHintBtn);
            finalHintBtn.parentNode.replaceChild(newFinalHintBtn, finalHintBtn);
            
            // Update references to the new buttons
            keyHintBtn = newKeyHintBtn;
            finalHintBtn = newFinalHintBtn;
            
            // Reset button states
            keyHintBtn.disabled = false;
            finalHintBtn.disabled = false;
            
            // Set up hint buttons with new event listeners
            keyHintBtn.addEventListener('click', () => {
                showConfirmationDialog("Are you sure you want to reveal a key hint?", () => {
                    showHint('key', personData.keyFacts);
                    keyHintRevealed = true;
                    keyHintBtn.disabled = true;
                });
            });
            
            finalHintBtn.addEventListener('click', () => {
                showConfirmationDialog("Are you sure you want to reveal the final clue?", () => {
                    showHint('final', personData.finalFact);
                    finalHintRevealed = true;
                    finalHintBtn.disabled = true;
                });
            });
        }
        
        // Show hint in a modal
        function showHint(type, content) {
            const modal = document.createElement('div');
            modal.classList.add('hint-modal');
            if (type === 'key') {
                modal.classList.add('key-hint-modal');
            } else {
                modal.classList.add('final-hint-modal');
            }
            
            const modalContent = document.createElement('div');
            modalContent.classList.add('hint-modal-content');
            
            const title = document.createElement('div');
            title.classList.add('hint-modal-title');
            title.textContent = type === 'key' ? 'Key Hint' : 'Final Clue';
            
            const badge = document.createElement('div');
            badge.classList.add(type === 'key' ? 'key-hint-badge' : 'final-hint-badge');
            badge.textContent = type === 'key' ? 'KEY HINT' : 'FINAL CLUE';
            modalContent.appendChild(badge);
            
            const text = document.createElement('div');
            text.classList.add('hint-modal-text');
            
            if (Array.isArray(content)) {
                // For key facts (array)
                text.innerHTML = content.join('<br><br>');
            } else {
                // For final fact (string)
                text.textContent = content;
            }
            
            const closeBtn = document.createElement('button');
            closeBtn.classList.add('hint-modal-close');
            closeBtn.textContent = 'Close';
            closeBtn.addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            modalContent.appendChild(title);
            modalContent.appendChild(text);
            modalContent.appendChild(closeBtn);
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
        }
        
        // Check the selected answer
        function checkAnswer(selectedPerson) {
            const isCorrect = selectedPerson === currentPerson;
            
            // Update score
            if (isCorrect) {
                score++;
            }
            
            // Add current person to used people
            if (!usedPeople.includes(currentPerson)) {
                usedPeople.push(currentPerson);
            }
            
            // Store result
            results.push({
                round: currentRound,
                correctPerson: currentPerson,
                selectedPerson: selectedPerson,
                isCorrect: isCorrect
            });
            
            // Show feedback
            showFeedback(isCorrect);
            
            // Mark the correct person
            document.querySelectorAll('.person-card').forEach(card => {
                if (card.dataset.person === currentPerson) {
                    card.classList.add('used');
                    
                    // If incorrect, highlight the correct answer
                    if (!isCorrect) {
                        card.classList.add('correct-answer');
                        setTimeout(() => {
                            card.classList.remove('correct-answer');
                        }, 1500);
                    }
                }
            });
            
            // Wait 2 seconds before moving to next round or results
            setTimeout(() => {
                if (currentRound < 6) {
                    startNewRound();
                } else {
                    showResults();
                }
            }, 2000);
        }
        
        // Start a new round
        function startNewRound() {
            // Update round indicator
            currentRound++;
            currentRoundElement.textContent = currentRound;
            
            // Update progress bar
            progressBar.style.width = `${(currentRound - 1) / 6 * 100}%`;
            
            // Clear feedback
            feedbackContainer.innerHTML = '';
            
            // Select a random person who hasn't been used yet
            const allPeople = Object.keys(people);
            const availablePeople = allPeople.filter(person => !usedPeople.includes(person));
            
            if (availablePeople.length > 0) {
                const randomIndex = Math.floor(Math.random() * availablePeople.length);
                currentPerson = availablePeople[randomIndex];
            } else {
                // If all people have been used, select a random one
                currentPerson = allPeople[Math.floor(Math.random() * allPeople.length)];
            }
            
            // Display facts and person selection
            displayFacts(currentPerson);
            displayPersonSelection();
        }
        
        // Show feedback after answering
        function showFeedback(isCorrect) {
            const feedback = document.createElement('div');
            feedback.classList.add('feedback');
            
            if (isCorrect) {
                feedback.classList.add('correct');
                feedback.innerHTML = '<i class="fas fa-check-circle"></i> Correct! Well done!';
                createConfetti();
            } else {
                feedback.classList.add('incorrect');
                feedback.innerHTML = `<i class="fas fa-times-circle"></i> Incorrect! The correct answer was ${currentPerson}.`;
            }
            
            feedbackContainer.innerHTML = '';
            feedbackContainer.appendChild(feedback);
        }
        
        // Show final results
        function showResults() {
            // Update screens
            quizScreen.classList.remove('active');
            resultsScreen.classList.add('active');
            
            // Update score display
            scoreValue.textContent = `${score}/6`;
            scoreText.textContent = `You got ${score} out of 6 correct!`;
            
            // Update results table
            resultsTableBody.innerHTML = '';
            
            results.forEach(result => {
                const tr = document.createElement('tr');
                tr.classList.add(result.isCorrect ? 'correct-row' : 'incorrect-row');
                
                const roundTd = document.createElement('td');
                roundTd.textContent = result.round;
                
                const correctTd = document.createElement('td');
                correctTd.textContent = result.correctPerson;
                
                const selectedTd = document.createElement('td');
                selectedTd.textContent = result.selectedPerson;
                
                const resultTd = document.createElement('td');
                if (result.isCorrect) {
                    resultTd.innerHTML = '<i class="fas fa-check-circle result-icon correct-icon"></i> Correct';
                } else {
                    resultTd.innerHTML = '<i class="fas fa-times-circle result-icon incorrect-icon"></i> Incorrect';
                }
                
                tr.appendChild(roundTd);
                tr.appendChild(correctTd);
                tr.appendChild(selectedTd);
                tr.appendChild(resultTd);
                
                resultsTableBody.appendChild(tr);
            });
            
            // If score is perfect, show confetti
            if (score === 6) {
                createConfetti();
            }
        }
        
        // Reset quiz
        function resetQuiz() {
            currentRound = 0;
            score = 0;
            results = [];
            currentPerson = '';
            usedPeople = [];
            keyHintRevealed = false;
            finalHintRevealed = false;
        }
        
        // Toggle dark mode
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            
            // Update icon
            const icon = darkModeToggle.querySelector('i');
            if (document.body.classList.contains('dark-mode')) {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            } else {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            }
        }
        
        // Initialize overview mode
        function startOverviewMode() {
            startScreen.classList.remove('active');
            quizScreen.classList.add('active');
            
            // In overview mode, show all people and their facts
            overviewMode = true;
            
            // Display all people
            displayPersonSelection();
            
            // Remove the "used" class from all cards in overview mode
            document.querySelectorAll('.person-card').forEach(card => {
                card.classList.remove('used');
                
                // Change click behavior in overview mode
                const newCard = card.cloneNode(true);
                card.parentNode.replaceChild(newCard, card);
                
                newCard.addEventListener('click', () => {
                    // Remove selected class from all cards
                    document.querySelectorAll('.person-card').forEach(c => {
                        c.classList.remove('selected');
                    });
                    
                    // Add selected class to this card
                    newCard.classList.add('selected');
                    
                    // Display facts for this person
                    displayFacts(newCard.dataset.person);
                });
            });
            
            // Hide progress and round indicators in overview mode
            document.querySelector('.progress-container').style.display = 'none';
            document.querySelector('.round-indicator').style.display = 'none';
            
            // Add a back button
            const backBtn = document.createElement('button');
            backBtn.classList.add('btn');
            backBtn.textContent = 'Back to Start';
            backBtn.style.marginTop = '20px';
            
            backBtn.addEventListener('click', () => {
                quizScreen.classList.remove('active');
                startScreen.classList.add('active');
                overviewMode = false;
                
                // Remove the back button when returning to start
                if (document.querySelector('.btn-container')) {
                    quizScreen.removeChild(document.querySelector('.btn-container'));
                }
            });
            
            const btnContainer = document.createElement('div');
            btnContainer.classList.add('btn-container');
            btnContainer.appendChild(backBtn);
            
            quizScreen.appendChild(btnContainer);
        }
        
        // Event listeners
        startBtn.addEventListener('click', () => {
            startScreen.classList.remove('active');
            quizScreen.classList.add('active');
            resetQuiz();
            startNewRound();
        });
        
        overviewBtn.addEventListener('click', startOverviewMode);
        
        playAgainBtn.addEventListener('click', () => {
            resetQuiz();
            resultsScreen.classList.remove('active');
            startScreen.classList.add('active');
        });
        
        darkModeToggle.addEventListener('click', toggleDarkMode);
        
        // Handle keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                if (startScreen.classList.contains('active')) {
                    startBtn.click();
                } else if (resultsScreen.classList.contains('active')) {
                    playAgainBtn.click();
                }
            }
        });
    </script>
</body>
</html>
